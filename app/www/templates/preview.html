<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>2FMusic Preview</title>
    <link rel="icon" href="{{ url_for('static', filename='images/ICON_256.PNG') }}">
    <script src="{{ url_for('static', filename='js/lib/color-thief.umd.js') }}"></script>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/font-awesome/all.min.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <script>
        (function () {
            function setScale() {
                if (window.innerWidth > 768) {
                    let scale = Math.min(Math.max(window.innerWidth / 1440, 0.8), 1.2);
                    document.documentElement.style.setProperty('--ui-scale', scale.toFixed(3));
                } else {
                    document.documentElement.style.setProperty('--ui-scale', '1.0');
                }
            }
            setScale();
            window.addEventListener('resize', setScale);
        })();
    </script>
    <style>
        /* Minimal overrides for preview specific context outside of main app */
        body {
            background-color: #000;
            overflow: hidden;
            margin: 0;
            padding: 0;
        }

        #full-player-overlay {
            /* Force relative positioning or fixed to fill screen since it's the only content */
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 1 !important;
            /* Force visible */
            pointer-events: auto !important;
            transform: none !important;
            background: linear-gradient(to bottom, #2c3e50, #000);
            /* Fallback bg */
        }
    </style>
</head>

<body class="preview-page">
    <!-- Copied directly from index.html #full-player-overlay structure -->
    <div id="full-player-overlay" class="active">
        <div class="fp-header">
            <!-- Open Home in new tab -->
            <button id="open-home-view"><i class="fas fa-home"></i></button>
            <span>2FMusic Preview</span>
            <div class="fp-header-right">
                <!-- Menu button for refresh action -->
                <button id="fp-menu-btn" class="icon-btn"><i class="fas fa-ellipsis-h"></i></button>
            </div>
        </div>

        <div class="fp-content">
            <div class="fp-art-area">
                <img src="{{ url_for('static', filename='images/ICON_256.PNG') }}" id="fp-cover" alt="Cover">
                <div class="fp-info">
                    <h2 id="fp-title">等待播放</h2>
                    <p id="fp-artist">2FMusic</p>
                </div>
            </div>

            <div class="fp-lyrics-area no-lyrics" id="lyrics-container">
                <p class="lyric-line active">暂无歌词</p>
            </div>
        </div>

        <div class="fp-controls">
            <div class="fp-progress-bar">
                <span id="fp-time-current">0:00</span>
                <input type="range" id="fp-progress-bar" value="0" min="0" max="100" step="0.1">
                <span id="fp-time-total">0:00</span>
            </div>
            <div class="fp-buttons">
                <button class="icon-btn" id="fp-btn-mode" title="切换模式"><i class="fas fa-redo"></i></button>
                <button class="play-btn play-huge" id="fp-btn-play"><i class="fas fa-play"></i></button>
                <button class="icon-btn" id="fp-btn-fav" title="收藏"><i class="far fa-heart"></i></button>
            </div>
        </div>
    </div>

    <div id="toast-container"></div>
    <audio id="audio-player"></audio>

    <script type="module" src="{{ url_for('static', filename='js/preview.js') }}"></script>
    <div id="action-menu-overlay" class="custom-overlay">
        <div class="action-sheet glass-panel">
            <button class="action-item" id="action-rematch">
                <i class="fas fa-sync-alt"></i> 刷新数据
            </button>
            <div style="height: 1px; background: rgba(255,255,255,0.1); margin: 0.5rem 0;"></div>
            <button class="action-item cancel" id="action-cancel">取消</button>
        </div>
    </div>
</body>

</html>